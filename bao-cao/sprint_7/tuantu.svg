<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2892.1875px" preserveAspectRatio="none" style="width:1746px;height:2892px;background:#FFFFFF;" version="1.1" viewBox="0 0 1746 2892" width="1746.875px" zoomAndPan="magnify"><defs/><g><rect fill="#E6F2FF" height="2521.3013" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="67.1875" y="142.6514"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="67.1875" y1="142.6514" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="82.8125" x2="82.8125" y1="142.6514" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="82.8125" y1="142.6514" y2="142.6514"/><rect fill="#E6F2FF" height="125.8301" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="67.1875" y="2727.71"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="67.1875" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="82.8125" x2="82.8125" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="82.8125" y1="2853.54" y2="2853.54"/><rect fill="#E6F2FF" height="322.1802" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="175.6714"/><rect fill="#E6F2FF" height="642.5903" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="567.0166"/><rect fill="#E6F2FF" height="274.8901" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="1255.127"/><rect fill="#E6F2FF" height="342.2852" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="1575.5371"/><rect fill="#E6F2FF" height="298.5352" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="1963.3423"/><rect fill="#E6F2FF" height="274.8901" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="2307.3975"/><rect fill="#E6F2FF" height="12.5" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="614.0625" y="2651.4526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="614.0625" y1="2651.4526" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="629.6875" x2="629.6875" y1="2651.4526" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="629.6875" y1="2651.4526" y2="2651.4526"/><rect fill="#E6F2FF" height="125.8301" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="614.0625" y="2727.71"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="614.0625" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="629.6875" x2="629.6875" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="629.6875" y1="2853.54" y2="2853.54"/><rect fill="#E6F2FF" height="183.8501" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="244.8364"/><rect fill="#E6F2FF" height="504.2603" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="636.1816"/><rect fill="#E6F2FF" height="160.2051" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="1300.647"/><rect fill="#E6F2FF" height="251.2451" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="1621.0571"/><rect fill="#E6F2FF" height="160.2051" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="2032.5073"/><rect fill="#E6F2FF" height="160.2051" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="2376.5625"/><rect fill="#E6F2FF" height="69.165" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="2784.375"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="314.0015"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="681.7017"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="796.3867"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="911.0718"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1025.7568"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1369.812"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1666.5771"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1781.2622"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="2101.6724"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="2445.7275"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="75" x2="75" y1="127.0264" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;stroke-dasharray:1.0,4.0;" x1="75" x2="75" y1="2663.9526" y2="2727.71"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="75" x2="75" y1="2727.71" y2="2881.665"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="621.0938" x2="621.0938" y1="127.0264" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;stroke-dasharray:1.0,4.0;" x1="621.0938" x2="621.0938" y1="2663.9526" y2="2727.71"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="621.0938" x2="621.0938" y1="2727.71" y2="2881.665"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="1128.125" x2="1128.125" y1="127.0264" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;stroke-dasharray:1.0,4.0;" x1="1128.125" x2="1128.125" y1="2663.9526" y2="2727.71"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="1128.125" x2="1128.125" y1="2727.71" y2="2881.665"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="1649.2188" x2="1649.2188" y1="127.0264" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;stroke-dasharray:1.0,4.0;" x1="1649.2188" x2="1649.2188" y1="2663.9526" y2="2727.71"/><line style="stroke:#3B82F6;stroke-width:0.78125;stroke-dasharray:5.0,5.0;" x1="1649.2188" x2="1649.2188" y1="2727.71" y2="2881.665"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacing" textLength="125" x="7.8125" y="121.8674">Người dùng</text><ellipse cx="75" cy="21.0938" fill="#E2E2F0" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.78125;"/><path d="M75,33.5938 L75,75.7813 M54.6875,46.0938 L95.3125,46.0938 M75,75.7813 L54.6875,99.2188 M75,75.7813 L95.3125,99.2188 " fill="none" style="stroke:#181818;stroke-width:0.78125;"/><rect fill="#E6F2FF" height="49.1577" rx="3.9063" ry="3.9063" style="stroke:#3B82F6;stroke-width:0.78125;" width="135.9375" x="553.9063" y="76.3062"/><text fill="#000000" font-family="sans-serif" font-size="23.4375" lengthAdjust="spacing" textLength="114.0625" x="564.8438" y="108.9989">:Giao diện</text><rect fill="#E6F2FF" height="49.1577" rx="3.9063" ry="3.9063" style="stroke:#3B82F6;stroke-width:0.78125;" width="134.375" x="1060.9375" y="76.3062"/><text fill="#000000" font-family="sans-serif" font-size="23.4375" lengthAdjust="spacing" textLength="112.5" x="1071.875" y="108.9989">:Hệ thống</text><rect fill="#E6F2FF" height="49.1577" rx="3.9063" ry="3.9063" style="stroke:#3B82F6;stroke-width:0.78125;" width="176.5625" x="1561.7188" y="76.3062"/><text fill="#000000" font-family="sans-serif" font-size="23.4375" lengthAdjust="spacing" textLength="154.6875" x="1572.6563" y="108.9989">:Cơ sở dữ liệu</text><rect fill="#E6F2FF" height="2521.3013" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="67.1875" y="142.6514"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="67.1875" y1="142.6514" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="82.8125" x2="82.8125" y1="142.6514" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="82.8125" y1="142.6514" y2="142.6514"/><rect fill="#E6F2FF" height="125.8301" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="67.1875" y="2727.71"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="67.1875" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="82.8125" x2="82.8125" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="67.1875" x2="82.8125" y1="2853.54" y2="2853.54"/><rect fill="#E6F2FF" height="322.1802" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="175.6714"/><rect fill="#E6F2FF" height="642.5903" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="567.0166"/><rect fill="#E6F2FF" height="274.8901" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="1255.127"/><rect fill="#E6F2FF" height="342.2852" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="1575.5371"/><rect fill="#E6F2FF" height="298.5352" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="1963.3423"/><rect fill="#E6F2FF" height="274.8901" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="614.0625" y="2307.3975"/><rect fill="#E6F2FF" height="12.5" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="614.0625" y="2651.4526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="614.0625" y1="2651.4526" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="629.6875" x2="629.6875" y1="2651.4526" y2="2663.9526"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="629.6875" y1="2651.4526" y2="2651.4526"/><rect fill="#E6F2FF" height="125.8301" style="stroke:#E6F2FF;stroke-width:1.5625;" width="15.625" x="614.0625" y="2727.71"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="614.0625" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="629.6875" x2="629.6875" y1="2727.71" y2="2853.54"/><line style="stroke:#3B82F6;stroke-width:1.5625;" x1="614.0625" x2="629.6875" y1="2853.54" y2="2853.54"/><rect fill="#E6F2FF" height="183.8501" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="244.8364"/><rect fill="#E6F2FF" height="504.2603" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="636.1816"/><rect fill="#E6F2FF" height="160.2051" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="1300.647"/><rect fill="#E6F2FF" height="251.2451" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="1621.0571"/><rect fill="#E6F2FF" height="160.2051" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="2032.5073"/><rect fill="#E6F2FF" height="160.2051" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="2376.5625"/><rect fill="#E6F2FF" height="69.165" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1120.3125" y="2784.375"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="314.0015"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="681.7017"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="796.3867"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="911.0718"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1025.7568"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1369.812"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1666.5771"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="1781.2622"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="2101.6724"/><rect fill="#E6F2FF" height="45.52" style="stroke:#3B82F6;stroke-width:1.5625;" width="15.625" x="1642.1875" y="2445.7275"/><polygon fill="#000000" points="595.3125,169.4214,610.9375,175.6714,595.3125,181.9214,601.5625,175.6714" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="175.6714" y2="175.6714"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="226.5625" x="93.75" y="167.7559">1. Mở chi tiết nhiệm vụ</text><polygon fill="#000000" points="1101.5625,238.5864,1117.1875,244.8364,1101.5625,251.0864,1107.8125,244.8364" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="629.6875" x2="1110.9375" y1="244.8364" y2="244.8364"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="309.375" x="640.625" y="213.2759">2. Yêu cầu danh sách bình luận</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="342.1875" x="640.625" y="236.9209">và tổng số bình luận của nhiệm vụ</text><polygon fill="#000000" points="1623.4375,307.7515,1639.0625,314.0015,1623.4375,320.2515,1629.6875,314.0015" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="314.0015" y2="314.0015"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="376.5625" x="1146.875" y="282.4409">3. Truy vấn các Comment theo TaskId</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="201.5625" x="1146.875" y="306.086">và tổng số bình luận</text><polygon fill="#000000" points="1153.125,353.2715,1137.5,359.5215,1153.125,365.7715,1146.875,359.5215" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="359.5215" y2="359.5215"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="454.6875" x="1162.5" y="351.606">[Thành công] Danh sách Comment + tổng số</text><polygon fill="#000000" points="646.875,422.4365,631.25,428.6865,646.875,434.9365,640.625,428.6865" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="637.5" x2="1126.5625" y1="428.6865" y2="428.6865"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="262.5" x="656.25" y="397.126">4. Trả danh sách bình luận</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="201.5625" x="656.25" y="420.771">và tổng số bình luận</text><polygon fill="#000000" points="100,491.6016,84.375,497.8516,100,504.1016,93.75,497.8516" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="90.625" x2="620.3125" y1="497.8516" y2="497.8516"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="309.375" x="109.375" y="466.291">5. Hiển thị danh sách bình luận</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="295.3125" x="109.375" y="489.9361">và số bình luận trên nhiệm vụ</text><polygon fill="#000000" points="595.3125,560.7666,610.9375,567.0166,595.3125,573.2666,601.5625,567.0166" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="567.0166" y2="567.0166"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="279.6875" x="93.75" y="535.4561">6a. Nhập nội dung bình luận</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="300" x="93.75" y="559.1011">và chọn file đính kèm (nếu có)</text><polygon fill="#000000" points="1101.5625,629.9316,1117.1875,636.1816,1101.5625,642.4316,1107.8125,636.1816" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="629.6875" x2="1110.9375" y1="636.1816" y2="636.1816"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="343.75" x="640.625" y="604.6211">6b. Gửi yêu cầu tạo Comment mới</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="460.9375" x="640.625" y="628.2661">(nội dung, TaskId, file, danh sách @username)</text><polygon fill="#000000" points="1623.4375,675.4517,1639.0625,681.7017,1623.4375,687.9517,1629.6875,681.7017" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="681.7017" y2="681.7017"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="221.875" x="1146.875" y="673.7862">6c. Lưu Comment mới</text><polygon fill="#000000" points="1153.125,720.9717,1137.5,727.2217,1153.125,733.4717,1146.875,727.2217" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="727.2217" y2="727.2217"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="254.6875" x="1162.5" y="719.3062">[Thành công] CommentId</text><polygon fill="#000000" points="1623.4375,790.1367,1639.0625,796.3867,1623.4375,802.6367,1629.6875,796.3867" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="796.3867" y2="796.3867"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="240.625" x="1146.875" y="764.8262">6d. Nếu có file đính kèm</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="343.75" x="1146.875" y="788.4712">lưu thông tin file gắn với Comment</text><polygon fill="#000000" points="1153.125,835.6567,1137.5,841.9067,1153.125,848.1567,1146.875,841.9067" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="841.9067" y2="841.9067"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="833.9912">[Thành công]</text><polygon fill="#000000" points="1623.4375,904.8218,1639.0625,911.0718,1623.4375,917.3218,1629.6875,911.0718" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="911.0718" y2="911.0718"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="325" x="1146.875" y="879.5113">6e. Nếu có mention @username</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="376.5625" x="1146.875" y="903.1563">lưu danh sách mention cho Comment</text><polygon fill="#000000" points="1153.125,950.3418,1137.5,956.5918,1153.125,962.8418,1146.875,956.5918" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="956.5918" y2="956.5918"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="948.6763">[Thành công]</text><polygon fill="#000000" points="1623.4375,1019.5068,1639.0625,1025.7568,1623.4375,1032.0068,1629.6875,1025.7568" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="1025.7568" y2="1025.7568"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="393.75" x="1146.875" y="994.1963">6f. Cập nhật tổng số bình luận của Task</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="476.5625" x="1146.875" y="1017.8413">và số bình luận chưa đọc của các user liên quan</text><polygon fill="#000000" points="1153.125,1065.0269,1137.5,1071.2769,1153.125,1077.5269,1146.875,1071.2769" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="1071.2769" y2="1071.2769"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="1063.3614">[Thành công]</text><polygon fill="#000000" points="646.875,1134.1919,631.25,1140.4419,646.875,1146.6919,640.625,1140.4419" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="637.5" x2="1126.5625" y1="1140.4419" y2="1140.4419"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="414.0625" x="656.25" y="1108.8814">6g. Trả kết quả tạo Comment thành công</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="265.625" x="656.25" y="1132.5264">kèm dữ liệu Comment mới</text><polygon fill="#000000" points="100,1203.3569,84.375,1209.6069,100,1215.8569,93.75,1209.6069" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="90.625" x2="620.3125" y1="1209.6069" y2="1209.6069"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="262.5" x="109.375" y="1178.0464">6h. Hiển thị bình luận mới,</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="335.9375" x="109.375" y="1201.6914">file đính kèm và highlight mention</text><polygon fill="#000000" points="595.3125,1248.877,610.9375,1255.127,595.3125,1261.377,601.5625,1255.127" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="1255.127" y2="1255.127"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="451.5625" x="93.75" y="1247.2115">7a. Chọn "Chỉnh sửa" một bình luận của mình</text><polygon fill="#000000" points="1101.5625,1294.397,1117.1875,1300.647,1101.5625,1306.897,1107.8125,1300.647" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="629.6875" x2="1110.9375" y1="1300.647" y2="1300.647"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="446.875" x="640.625" y="1292.7315">7b. Gửi yêu cầu cập nhật nội dung Comment</text><polygon fill="#000000" points="1623.4375,1363.562,1639.0625,1369.812,1623.4375,1376.062,1629.6875,1369.812" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="1369.812" y2="1369.812"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="420.3125" x="1146.875" y="1338.2515">7c. Cập nhật nội dung Comment trong DB</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="217.1875" x="1146.875" y="1361.8965">và thời gian chỉnh sửa</text><polygon fill="#000000" points="1153.125,1409.082,1137.5,1415.332,1153.125,1421.582,1146.875,1415.332" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="1415.332" y2="1415.332"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="1407.4165">[Thành công]</text><polygon fill="#000000" points="646.875,1454.6021,631.25,1460.8521,646.875,1467.1021,640.625,1460.8521" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="637.5" x2="1126.5625" y1="1460.8521" y2="1460.8521"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="340.625" x="656.25" y="1452.9366">7d. Trả kết quả cập nhật bình luận</text><polygon fill="#000000" points="100,1523.7671,84.375,1530.0171,100,1536.2671,93.75,1530.0171" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="90.625" x2="620.3125" y1="1530.0171" y2="1530.0171"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="437.5" x="109.375" y="1498.4566">7e. Hiển thị nội dung bình luận đã chỉnh sửa</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="287.5" x="109.375" y="1522.1016">(kèm thông tin đã chỉnh sửa)</text><polygon fill="#000000" points="595.3125,1569.2871,610.9375,1575.5371,595.3125,1581.7871,601.5625,1575.5371" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="1575.5371" y2="1575.5371"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="245.3125" x="93.75" y="1567.6216">8a. Chọn "Xóa bình luận"</text><polygon fill="#000000" points="1101.5625,1614.8071,1117.1875,1621.0571,1101.5625,1627.3071,1107.8125,1621.0571" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="629.6875" x2="1110.9375" y1="1621.0571" y2="1621.0571"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="303.125" x="640.625" y="1613.1416">8b. Gửi yêu cầu xóa Comment</text><polygon fill="#000000" points="1623.4375,1660.3271,1639.0625,1666.5771,1623.4375,1672.8271,1629.6875,1666.5771" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="1666.5771" y2="1666.5771"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="454.6875" x="1146.875" y="1658.6617">8c. Xóa Comment (và file đính kèm liên quan)</text><polygon fill="#000000" points="1153.125,1705.8472,1137.5,1712.0972,1153.125,1718.3472,1146.875,1712.0972" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="1712.0972" y2="1712.0972"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="1704.1817">[Thành công]</text><polygon fill="#000000" points="1623.4375,1775.0122,1639.0625,1781.2622,1623.4375,1787.5122,1629.6875,1781.2622" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="1781.2622" y2="1781.2622"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="334.375" x="1146.875" y="1749.7017">8d. Cập nhật lại tổng số bình luận</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="348.4375" x="1146.875" y="1773.3467">và số bình luận chưa đọc (nếu cần)</text><polygon fill="#000000" points="1153.125,1820.5322,1137.5,1826.7822,1153.125,1833.0322,1146.875,1826.7822" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="1826.7822" y2="1826.7822"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="1818.8667">[Thành công]</text><polygon fill="#000000" points="646.875,1866.0522,631.25,1872.3022,646.875,1878.5522,640.625,1872.3022" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="637.5" x2="1126.5625" y1="1872.3022" y2="1872.3022"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="289.0625" x="656.25" y="1864.3867">8e. Trả kết quả xóa bình luận</text><polygon fill="#000000" points="100,1911.5723,84.375,1917.8223,100,1924.0723,93.75,1917.8223" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="90.625" x2="620.3125" y1="1917.8223" y2="1917.8223"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="356.25" x="109.375" y="1909.9068">8f. Loại bỏ bình luận khỏi danh sách</text><polygon fill="#000000" points="595.3125,1957.0923,610.9375,1963.3423,595.3125,1969.5923,601.5625,1963.3423" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="1963.3423" y2="1963.3423"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="501.5625" x="93.75" y="1955.4268">9a. Mở danh sách nhiệm vụ hoặc chi tiết nhiệm vụ</text><polygon fill="#000000" points="1101.5625,2026.2573,1117.1875,2032.5073,1101.5625,2038.7573,1107.8125,2032.5073" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="629.6875" x2="1110.9375" y1="2032.5073" y2="2032.5073"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="339.0625" x="640.625" y="2000.9468">9b. Yêu cầu số bình luận chưa đọc</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="345.3125" x="640.625" y="2024.5918">của người dùng cho từng nhiệm vụ</text><polygon fill="#000000" points="1623.4375,2095.4224,1639.0625,2101.6724,1623.4375,2107.9224,1629.6875,2101.6724" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="2101.6724" y2="2101.6724"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="353.125" x="1146.875" y="2070.1118">9c. Truy vấn số Comment chưa đọc</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="214.0625" x="1146.875" y="2093.7569">theo UserId và TaskId</text><polygon fill="#000000" points="1153.125,2140.9424,1137.5,2147.1924,1153.125,2153.4424,1146.875,2147.1924" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="2147.1924" y2="2147.1924"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="354.6875" x="1162.5" y="2139.2769">[Thành công] Thống kê số chưa đọc</text><polygon fill="#000000" points="646.875,2186.4624,631.25,2192.7124,646.875,2198.9624,640.625,2192.7124" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="637.5" x2="1126.5625" y1="2192.7124" y2="2192.7124"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="364.0625" x="656.25" y="2184.7969">9d. Trả dữ liệu số bình luận chưa đọc</text><polygon fill="#000000" points="100,2255.6274,84.375,2261.8774,100,2268.1274,93.75,2261.8774" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="90.625" x2="620.3125" y1="2261.8774" y2="2261.8774"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="407.8125" x="109.375" y="2230.3169">9e. Hiển thị badge số bình luận chưa đọc</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="476.5625" x="109.375" y="2253.9619">trên từng nhiệm vụ hoặc trong chi tiết nhiệm vụ</text><polygon fill="#000000" points="595.3125,2301.1475,610.9375,2307.3975,595.3125,2313.6475,601.5625,2307.3975" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="2307.3975" y2="2307.3975"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="498.4375" x="93.75" y="2299.482">10a. Cuộn xem danh sách bình luận của nhiệm vụ</text><polygon fill="#000000" points="1101.5625,2370.3125,1117.1875,2376.5625,1101.5625,2382.8125,1107.8125,2376.5625" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="629.6875" x2="1110.9375" y1="2376.5625" y2="2376.5625"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="340.625" x="640.625" y="2345.002">10b. Gửi yêu cầu đánh dấu đã đọc</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="223.4375" x="640.625" y="2368.647">các bình luận vừa xem</text><polygon fill="#000000" points="1623.4375,2439.4775,1639.0625,2445.7275,1623.4375,2451.9775,1629.6875,2445.7275" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="1135.9375" x2="1632.8125" y1="2445.7275" y2="2445.7275"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="315.625" x="1146.875" y="2414.167">10c. Cập nhật trạng thái đã đọc</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="290.625" x="1146.875" y="2437.812">cho các Comment tương ứng</text><polygon fill="#000000" points="1153.125,2484.9976,1137.5,2491.2476,1153.125,2497.4976,1146.875,2491.2476" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="1143.75" x2="1648.4375" y1="2491.2476" y2="2491.2476"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="131.25" x="1162.5" y="2483.3321">[Thành công]</text><polygon fill="#000000" points="646.875,2530.5176,631.25,2536.7676,646.875,2543.0176,640.625,2536.7676" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="637.5" x2="1126.5625" y1="2536.7676" y2="2536.7676"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="329.6875" x="656.25" y="2528.8521">10d. Trả kết quả cập nhật đã đọc</text><polygon fill="#000000" points="100,2576.0376,84.375,2582.2876,100,2588.5376,93.75,2582.2876" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="90.625" x2="620.3125" y1="2582.2876" y2="2582.2876"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="392.1875" x="109.375" y="2574.3721">10e. Cập nhật lại số bình luận chưa đọc</text><polygon fill="#000000" points="595.3125,2645.2026,610.9375,2651.4526,595.3125,2657.7026,601.5625,2651.4526" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="82.8125" x2="604.6875" y1="2651.4526" y2="2651.4526"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="414.0625" x="93.75" y="2619.8921">11a. Đang mở màn hình chi tiết nhiệm vụ</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="234.375" x="93.75" y="2643.5371">với danh sách bình luận</text><text fill="#000000" font-family="sans-serif" font-size="17.1875" lengthAdjust="spacing" textLength="251.5625" x="736.7188" y="2701.7815">Thao tác từ người dùng khác</text><polygon fill="#000000" points="646.875,2778.125,631.25,2784.375,646.875,2790.625,640.625,2784.375" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;" x1="637.5" x2="1118.75" y1="2784.375" y2="2784.375"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="307.8125" x="656.25" y="2752.8145">11b. Đẩy sự kiện thời gian thực</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="284.375" x="656.25" y="2776.4595">(thêm / sửa / xóa Comment)</text><polygon fill="#000000" points="92.1875,2847.29,76.5625,2853.54,92.1875,2859.79,85.9375,2853.54" style="stroke:#000000;stroke-width:1.5625;"/><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:2.0,2.0;" x1="82.8125" x2="620.3125" y1="2853.54" y2="2853.54"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="428.125" x="101.5625" y="2821.9795">11c. Tự động cập nhật danh sách bình luận</text><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacing" textLength="246.875" x="101.5625" y="2845.6245">và số bình luận chưa đọc</text><!--MD5=[69cef3856a489a5f73976ff9d00af25e]
@startuml
!pragma useUnicode true
skinparam dpi 150
skinparam sequence {
  LifeLineBorderColor #3B82F6
  LifeLineBackgroundColor #E6F2FF
  ArrowColor #000000
  ParticipantFontSize 15
  BoxFontSize 15
  ParticipantBorderColor #3B82F6
  ParticipantBackgroundColor #E6F2FF
}
hide footbox

actor "Người dùng" as User
participant ":Giao diện" as UI
participant ":Hệ thống" as System
participant ":Cơ sở dữ liệu" as DB

' - - - Người dùng hoạt động suốt quá trình - - -
activate User

' === 1. Hiển thị danh sách bình luận và tổng số bình luận ===
User -> UI: 1. Mở chi tiết nhiệm vụ
activate UI
UI -> System: 2. Yêu cầu danh sách bình luận\nvà tổng số bình luận của nhiệm vụ
activate System
System -> DB: 3. Truy vấn các Comment theo TaskId\nvà tổng số bình luận
activate DB
DB - -> System: [Thành công] Danh sách Comment + tổng số
deactivate DB
System - -> UI: 4. Trả danh sách bình luận\nvà tổng số bình luận
deactivate System
UI - -> User: 5. Hiển thị danh sách bình luận\nvà số bình luận trên nhiệm vụ
deactivate UI

' === 2. Thêm bình luận (có thể kèm file đính kèm và mention) ===
User -> UI: 6a. Nhập nội dung bình luận\nvà chọn file đính kèm (nếu có)
activate UI
UI -> System: 6b. Gửi yêu cầu tạo Comment mới\n(nội dung, TaskId, file, danh sách @username)
activate System
System -> DB: 6c. Lưu Comment mới
activate DB
DB - -> System: [Thành công] CommentId
deactivate DB

System -> DB: 6d. Nếu có file đính kèm\nlưu thông tin file gắn với Comment
activate DB
DB - -> System: [Thành công]
deactivate DB

System -> DB: 6e. Nếu có mention @username\nlưu danh sách mention cho Comment
activate DB
DB - -> System: [Thành công]
deactivate DB

System -> DB: 6f. Cập nhật tổng số bình luận của Task\nvà số bình luận chưa đọc của các user liên quan
activate DB
DB - -> System: [Thành công]
deactivate DB

System - -> UI: 6g. Trả kết quả tạo Comment thành công\nkèm dữ liệu Comment mới
deactivate System
UI - -> User: 6h. Hiển thị bình luận mới,\nfile đính kèm và highlight mention
deactivate UI

' === 3. Chỉnh sửa bình luận ===
User -> UI: 7a. Chọn "Chỉnh sửa" một bình luận của mình
activate UI
UI -> System: 7b. Gửi yêu cầu cập nhật nội dung Comment
activate System
System -> DB: 7c. Cập nhật nội dung Comment trong DB\nvà thời gian chỉnh sửa
activate DB
DB - -> System: [Thành công]
deactivate DB
System - -> UI: 7d. Trả kết quả cập nhật bình luận
deactivate System
UI - -> User: 7e. Hiển thị nội dung bình luận đã chỉnh sửa\n(kèm thông tin đã chỉnh sửa)
deactivate UI

' === 4. Xóa bình luận ===
User -> UI: 8a. Chọn "Xóa bình luận"
activate UI
UI -> System: 8b. Gửi yêu cầu xóa Comment
activate System
System -> DB: 8c. Xóa Comment (và file đính kèm liên quan)
activate DB
DB - -> System: [Thành công]
deactivate DB

System -> DB: 8d. Cập nhật lại tổng số bình luận\nvà số bình luận chưa đọc (nếu cần)
activate DB
DB - -> System: [Thành công]
deactivate DB

System - -> UI: 8e. Trả kết quả xóa bình luận
deactivate System
UI - -> User: 8f. Loại bỏ bình luận khỏi danh sách
deactivate UI

' === 5. Hiển thị số bình luận chưa đọc của người dùng ===
User -> UI: 9a. Mở danh sách nhiệm vụ hoặc chi tiết nhiệm vụ
activate UI
UI -> System: 9b. Yêu cầu số bình luận chưa đọc\ncủa người dùng cho từng nhiệm vụ
activate System
System -> DB: 9c. Truy vấn số Comment chưa đọc\ntheo UserId và TaskId
activate DB
DB - -> System: [Thành công] Thống kê số chưa đọc
deactivate DB
System - -> UI: 9d. Trả dữ liệu số bình luận chưa đọc
deactivate System
UI - -> User: 9e. Hiển thị badge số bình luận chưa đọc\ntrên từng nhiệm vụ hoặc trong chi tiết nhiệm vụ
deactivate UI

' === 6. Cập nhật trạng thái đã đọc khi người dùng xem bình luận ===
User -> UI: 10a. Cuộn xem danh sách bình luận của nhiệm vụ
activate UI
UI -> System: 10b. Gửi yêu cầu đánh dấu đã đọc\ncác bình luận vừa xem
activate System
System -> DB: 10c. Cập nhật trạng thái đã đọc\ncho các Comment tương ứng
activate DB
DB - -> System: [Thành công]
deactivate DB
System - -> UI: 10d. Trả kết quả cập nhật đã đọc
deactivate System
UI - -> User: 10e. Cập nhật lại số bình luận chưa đọc
deactivate UI

' === 7. Cập nhật bình luận theo thời gian thực ===
User -> UI: 11a. Đang mở màn hình chi tiết nhiệm vụ\nvới danh sách bình luận
activate UI
... Thao tác từ người dùng khác ...
System -> UI: 11b. Đẩy sự kiện thời gian thực\n(thêm / sửa / xóa Comment)
activate System
UI - -> User: 11c. Tự động cập nhật danh sách bình luận\nvà số bình luận chưa đọc
deactivate System
deactivate UI

deactivate User
@enduml

@startuml
!pragma useUnicode true
skinparam dpi 150
skinparam sequence {
  LifeLineBorderColor #3B82F6
  LifeLineBackgroundColor #E6F2FF
  ArrowColor #000000
  ParticipantFontSize 15
  BoxFontSize 15
  ParticipantBorderColor #3B82F6
  ParticipantBackgroundColor #E6F2FF
}
hide footbox

actor "Người dùng" as User
participant ":Giao diện" as UI
participant ":Hệ thống" as System
participant ":Cơ sở dữ liệu" as DB

activate User

User -> UI: 1. Mở chi tiết nhiệm vụ
activate UI
UI -> System: 2. Yêu cầu danh sách bình luận\nvà tổng số bình luận của nhiệm vụ
activate System
System -> DB: 3. Truy vấn các Comment theo TaskId\nvà tổng số bình luận
activate DB
DB - -> System: [Thành công] Danh sách Comment + tổng số
deactivate DB
System - -> UI: 4. Trả danh sách bình luận\nvà tổng số bình luận
deactivate System
UI - -> User: 5. Hiển thị danh sách bình luận\nvà số bình luận trên nhiệm vụ
deactivate UI

User -> UI: 6a. Nhập nội dung bình luận\nvà chọn file đính kèm (nếu có)
activate UI
UI -> System: 6b. Gửi yêu cầu tạo Comment mới\n(nội dung, TaskId, file, danh sách @username)
activate System
System -> DB: 6c. Lưu Comment mới
activate DB
DB - -> System: [Thành công] CommentId
deactivate DB

System -> DB: 6d. Nếu có file đính kèm\nlưu thông tin file gắn với Comment
activate DB
DB - -> System: [Thành công]
deactivate DB

System -> DB: 6e. Nếu có mention @username\nlưu danh sách mention cho Comment
activate DB
DB - -> System: [Thành công]
deactivate DB

System -> DB: 6f. Cập nhật tổng số bình luận của Task\nvà số bình luận chưa đọc của các user liên quan
activate DB
DB - -> System: [Thành công]
deactivate DB

System - -> UI: 6g. Trả kết quả tạo Comment thành công\nkèm dữ liệu Comment mới
deactivate System
UI - -> User: 6h. Hiển thị bình luận mới,\nfile đính kèm và highlight mention
deactivate UI

User -> UI: 7a. Chọn "Chỉnh sửa" một bình luận của mình
activate UI
UI -> System: 7b. Gửi yêu cầu cập nhật nội dung Comment
activate System
System -> DB: 7c. Cập nhật nội dung Comment trong DB\nvà thời gian chỉnh sửa
activate DB
DB - -> System: [Thành công]
deactivate DB
System - -> UI: 7d. Trả kết quả cập nhật bình luận
deactivate System
UI - -> User: 7e. Hiển thị nội dung bình luận đã chỉnh sửa\n(kèm thông tin đã chỉnh sửa)
deactivate UI

User -> UI: 8a. Chọn "Xóa bình luận"
activate UI
UI -> System: 8b. Gửi yêu cầu xóa Comment
activate System
System -> DB: 8c. Xóa Comment (và file đính kèm liên quan)
activate DB
DB - -> System: [Thành công]
deactivate DB

System -> DB: 8d. Cập nhật lại tổng số bình luận\nvà số bình luận chưa đọc (nếu cần)
activate DB
DB - -> System: [Thành công]
deactivate DB

System - -> UI: 8e. Trả kết quả xóa bình luận
deactivate System
UI - -> User: 8f. Loại bỏ bình luận khỏi danh sách
deactivate UI

User -> UI: 9a. Mở danh sách nhiệm vụ hoặc chi tiết nhiệm vụ
activate UI
UI -> System: 9b. Yêu cầu số bình luận chưa đọc\ncủa người dùng cho từng nhiệm vụ
activate System
System -> DB: 9c. Truy vấn số Comment chưa đọc\ntheo UserId và TaskId
activate DB
DB - -> System: [Thành công] Thống kê số chưa đọc
deactivate DB
System - -> UI: 9d. Trả dữ liệu số bình luận chưa đọc
deactivate System
UI - -> User: 9e. Hiển thị badge số bình luận chưa đọc\ntrên từng nhiệm vụ hoặc trong chi tiết nhiệm vụ
deactivate UI

User -> UI: 10a. Cuộn xem danh sách bình luận của nhiệm vụ
activate UI
UI -> System: 10b. Gửi yêu cầu đánh dấu đã đọc\ncác bình luận vừa xem
activate System
System -> DB: 10c. Cập nhật trạng thái đã đọc\ncho các Comment tương ứng
activate DB
DB - -> System: [Thành công]
deactivate DB
System - -> UI: 10d. Trả kết quả cập nhật đã đọc
deactivate System
UI - -> User: 10e. Cập nhật lại số bình luận chưa đọc
deactivate UI

User -> UI: 11a. Đang mở màn hình chi tiết nhiệm vụ\nvới danh sách bình luận
activate UI
... Thao tác từ người dùng khác ...
System -> UI: 11b. Đẩy sự kiện thời gian thực\n(thêm / sửa / xóa Comment)
activate System
UI - -> User: 11c. Tự động cập nhật danh sách bình luận\nvà số bình luận chưa đọc
deactivate System
deactivate UI

deactivate User
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>